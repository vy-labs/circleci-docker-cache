description: >
  This command generates docker cache key
parameters:
  key_docker:
    type: string
    default: docker-layer-caching-key-{{ checksum "/tmp/docker-layer-caching-key.txt" }}
    description: "Cache key"
  paths:
    type: string
    default: /tmp/docker-layer-caching-key.txt
    description: "Cache paths"
steps:
  - run:
      name: get checksum key
      command: checksum_key=$(cat /tmp/checksum_key)
      environment:
        CHECKSUM_KEY: $checksum_key
  - save_cache:
      key: <<parameters.key_docker>>
      paths:
        - <<parameters.paths>>
  - save_cache:
      key: <<parameters.key_docker>>-{{ .Environment.CHECKSUM_KEY }}
      paths:
        - <<parameters.paths>>
